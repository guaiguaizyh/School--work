C51 COMPILER V9.00   1602                                                                  12/08/2019 16:29:23 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE 1602
OBJECT MODULE PLACED IN 1602.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\KEIL\C51\BIN\C51.EXE 1602.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <1602.h>
   2          #define DATA P0
   3          sbit LCDEN=P2^7;
   4          sbit RW=P2^5;
   5          sbit RS=P2^6; 
   6          
   7          u8 DectectBusyBit( )//×´Ì¬ÅÐ¶Ïº¯Êý(Ã¦/ÏÐ?)
   8          {   
   9   1              u8 result;
  10   1              DATA = 0xff;    //¶Á×´Ì¬Ç°ÏÈÖÃ¸ßµçÆ½£¬·ÀÖ¹ÎóÅÐ
  11   1              RS = 0;
  12   1              delay_ms(5);
  13   1          RW = 1;
  14   1              LCDEN = 1;
  15   1              delay_ms(5);
  16   1              result=DATA&0x80; //È¡×î¸ßÎ»¼´ÎªÃ¦±ê¼Ç£¬ÈôLCMÃ¦,Ôò·´¸´²âÊÔ,ÔÚ´Ë´¦Ô­µØÌ¤²½£»µ±LCMÏÐÊ±£¬²ÅÍùÏÂ¼ÌÐø
  17   1              LCDEN = 0;
  18   1              return result;                
  19   1      }               
  20          
  21          void WrComLCD(u8 ComVal)//Ð´ÃüÁîº¯Êý
  22          {
  23   1              while(DectectBusyBit()==1);         //ÏÈ¼ì²âLCMÊÇ·ñ¿ÕÏÐ
  24   1              RS = 0;
  25   1              delay_ms(1);
  26   1          RW = 0;
  27   1              LCDEN = 1;
  28   1              DATA = ComVal;
  29   1              delay_ms(1);
  30   1              LCDEN = 0;      
  31   1      }
  32          
  33          void WrDatLCD(u8 DatVal)//Ð´Êý¾Ýº¯Êý
  34          {
  35   1              while(DectectBusyBit()==1); 
  36   1              RS = 1;
  37   1              delay_ms(1);
  38   1          RW = 0;
  39   1              LCDEN = 1;
  40   1              DATA = DatVal;
  41   1              delay_ms(1);
  42   1              LCDEN = 0;      
  43   1      }
  44          
  45          u8 RdACAdr(void)//¶Áµ±Ç°¹â±êµØÖ·
  46          {   
  47   1              u8 result;
  48   1              DATA = 0xff;    //¶ÁµØÖ·Ç°ÏÈÖÃ¸ßµçÆ½£¬·ÀÖ¹ÎóÅÐ
  49   1              RS = 0;
  50   1              delay_ms(5);
  51   1          RW = 1;
  52   1              LCDEN = 1;
  53   1              delay_ms(5);
  54   1              result=DATA&0x7f; //È¥µô×î¸ßÎ»Ã¦ÏÐ±ê¼Ç£¬Ö»±£ÁôµÍ7Î»µØÖ·Öµ
  55   1              LCDEN = 0;
C51 COMPILER V9.00   1602                                                                  12/08/2019 16:29:23 PAGE 2   

  56   1              return result;                
  57   1      } 
  58          
  59          void retACAdr(u8 add)//·µ»Øµ½Ä³¸ö¹â±êµØÖ·
  60          {   
  61   1          WrComLCD(0x80+add);       
  62   1      }
  63          
  64          void LCD1602pos(u8 x,u8 y)//1602ÏÔÊ¾×ø±ê¶¨Î»º¯Êý£ºxÎªÐÐ±ê£¬0£ºµÚÒ»ÐÐ£¬1£ºµÚ¶þÐÐ£»yÎªÁÐ±ê£¬0-15
  65          {
  66   1              u8 t;
  67   1              t=x?0x40:0x00;
  68   1              WrComLCD(0x80+t+y);  
  69   1      }
  70          
  71          void LCD1602_Init( )//1602³õÊ¼»¯º¯Êý
  72          { 
  73   1              WrComLCD(0x38);     // ¹¦ÄÜÉè¶¨:16*2ÐÐ¡¢5*7µãÕó¡¢8Î»Êý¾Ý½Ó¿Ú
  74   1              WrComLCD(0x38);
  75   1              WrComLCD(0x38);    
  76   1      //¶à´ÎÖØ¸´Éè¶¨¹¦ÄÜÖ¸Áî,ÒòÎªLCDÆô¶¯ºó²¢²»ÖªµÀÊ¹ÓÃµÄÊÇ4Î»Êý¾Ý½Ó¿Ú»¹ÊÇ8Î»µÄ£¬ËùÒÔ¿ªÊ¼Ê±×ÜÊÇÄ¬ÈÏÎª4Î»£¬ÕâÑù¸Õ¿
             -ªÊ¼Ð´Èë¹¦ÄÜÉè¶¨Ö¸ÁîÊ±£¬µÍ4Î»±»ºöÂÔ,ÎªÁË¿É¿¿£¬×îºÃ¶àÐ´¼¸±é¸ÃÖ¸Áî 
  77   1              WrComLCD(0x01);    // ÇåÆÁ 
  78   1              WrComLCD(0x06);    // ¹â±ê×ÔÔö¡¢ÆÁÄ»²»¶¯  
  79   1              delay_ms(1);          // ÑÓÊ±£¬µÈ´ýÉÏÃæµÄÖ¸ÁîÉúÐ§£¬ÏÂÃæÔÙÏÔÊ¾£¬·ÀÖ¹³öÏÖÂÒÂë
  80   1              WrComLCD(0x0c);    // ¿ªÏÔÊ¾¡¢¹Ø¹â±ê
  81   1              LCD1602pos(0,0);//´ÓµÚÒ»ÐÐµÚÒ»¸ö×Ö·û¿ªÊ¼ÏÔÊ¾
  82   1              delay_ms(5);
  83   1      }
  84          
  85          void LCD1602_disstr(u8 *p,u8 x,u8 y)//´ÓÖ¸¶¨×ø±ê¿ªÊ¼ÏÔÊ¾Ó¢ÎÄ×Ö·û´®£¨³¤¶È²»³¬¹ý32£©£¬×Ô¶¯»»ÐÐ
  86          {       
  87   1              u8 i=0;
  88   1          LCD1602pos(x,y);
  89   1              while(p[i]!='\0')
  90   1              {  
  91   2                      WrDatLCD(p[i]);
  92   2                      i++;
  93   2                      delay_ms(5);
  94   2              
  95   2      //          if((y+i)%16==0)  //Ò»ÐÐÏÔÊ¾µ½Ä©Î²
  96   2      //              {  
  97   2      //                  x=x^0x01;//ÇÐ»»µ½ÁíÒ»ÐÐ£¬Èç¹ûµÚ1ÐÐÐ´Íê»»ÐÐµ½µÚ2ÐÐ,Èç¹ûµÚ2ÐÐÐ´Íê»»ÐÐµ½µÚ1ÐÐ
  98   2      //                  LCD1602pos(x,0);//ÉèÖÃÏÔÊ¾µØÖ·ÎªÁíÒ»ÐÐÐÐÊ×
  99   2      //              }               
 100   2              }       
 101   1      }
 102          void LCD1602_disnum(long n,u8 x,u8 y)//´ÓÖ¸¶¨×ø±ê¿ªÊ¼ÏÔÊ¾³¤ÕûÊý
 103          {       
 104   1              u8 i=0,j=0;
 105   1              u8 p[17],q[17]="          ";//²¢Çå³ýµÚ¶þÐÐ¡£¡£¡£¡£¡£¡£¡£¡£
 106   1              long m;
 107   1              if(n<0) m=-n;
 108   1              else    m=n;  
 109   1              while(m)
 110   1              {p[i++]=m%10+'0';
 111   2               m=m/10;
 112   2              }
 113   1              p[i--]='\0';
 114   1              if(n<0) q[j++]='-';
 115   1              while(i)
 116   1                      q[j++]=p[i--];
C51 COMPILER V9.00   1602                                                                  12/08/2019 16:29:23 PAGE 3   

 117   1              q[j++]=p[i];
 118   1              LCD1602_disstr(q,x,y);
 119   1      }
 120          void LCD1602_disch_x_y(u8 ch,u8 x,u8 y)//ÔÚÖ¸¶¨Î»ÖÃÏÔÊ¾Ò»¸öÓ¢ÎÄ×Ö·û
 121          {       
 122   1              LCD1602pos(x,y);
 123   1              WrDatLCD(ch);
 124   1              delay_ms(5);    
 125   1      }
 126          void LCD1602_disch(u8 ch)//ÔÚµ±Ç°Î»ÖÃÏÔÊ¾Ò»¸öÓ¢ÎÄ×Ö·û
 127          {       
 128   1              WrDatLCD(ch);
 129   1              delay_ms(5);    
 130   1      }
 131          void LCD1602_clear( )//1602ÇåÆÁº¯Êý
 132          {
 133   1              WrComLCD(0x01);    // ÇåÆÁ
 134   1      } 
 135          
 136          void LCD1602_return( )//1602·µ»Øº¯Êý
 137          {
 138   1              WrComLCD(0x02);    // ÇåÆÁ
 139   1      } 
 140          
 141          void LCD1602_backspace( )//Ïò×óÉ¾³ýÒ»¸ö×Ö·û
 142          {
 143   1              WrComLCD(0x10);//¹â±ê×óÒÆ
 144   1              WrDatLCD(' ');//Êä³ö¿Õ¸ñ
 145   1              WrComLCD(0x10);//¹â±ê×óÒÆ
 146   1      }
 147          
 148          void LCD1602_cursor(u8 direct)//¹â±ê×óÓÒÒÆ¶¯£¬direct=0£¬×óÒÆ£¬direct=1£¬ÓÒÒÆ
 149          {
 150   1              if(direct) WrComLCD(0x14);//¹â±êÓÒÒÆ
 151   1          else           WrComLCD(0x10);//¹â±ê×óÒÆ    
 152   1              
 153   1      }
 154          
 155          void LCD1602_screen(u8 direct)//ÆÁÄ»×óÓÒÒÆ¶¯£¬direct=0£¬×óÒÆ£¬direct=1£¬ÓÒÒÆ
 156          {
 157   1              if(direct) WrComLCD(0x1C);//ÆÁÄ»ÓÒÒÆ
 158   1          else           WrComLCD(0x18);//ÆÁÄ»×óÒÆ    
 159   1              
 160   1      }
 161          void LCD1602_pow(u8 x)//´ò¿ª(1)»ò¹Ø±Õ(0)ÏÔÊ¾
 162          { 
 163   1              if(x==1)WrComLCD(0x0f); //¿ªÏÔÊ¾
 164   1              if(x==0)WrComLCD(0x08); //¹ØÏÔÊ¾
 165   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    568    ----
   CONSTANT SIZE    =     17    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      56
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
