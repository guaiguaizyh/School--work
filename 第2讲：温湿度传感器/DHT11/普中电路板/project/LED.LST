C51 COMPILER V9.00   LED                                                                   12/08/2019 16:49:42 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN LED.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\KEIL\C51\BIN\C51.EXE LED.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <led.h>
   2          
   3          //数据线接口
   4          #define LEDDAT P0
   5          
   6          //通过译码器输出位选
   7          sbit LSA=P2^2; 
   8          sbit LSB=P2^3;
   9          sbit LSC=P2^4; 
  10          
  11          u8 code table[]={
  12          0x3f,0x06,0x5b,0x4f,
  13          0x66,0x6d,0x7d,0x07,
  14          0x7f,0x6f,0x77,0x7c,
  15          0x39,0x5e,0x79,0x71,0x00}; //共阴数码管编码
  16          
  17          void Print_u32_LED(u32 n)//输出6位无符号整数(0-99999999)到8位数码管,不足8位时，前面不显示
  18          {u8 i;
  19   1       if(n==0) //若该数为0时直接显示0
  20   1       {
  21   2              LSA=0;LSB=0;LSC=0; //位选
  22   2      
  23   2              LEDDAT=table[0]; //更新段码
  24   2              
  25   2              delay_ms(1); //间隔一段时间扫描 
  26   2              
  27   2              LEDDAT=0x00;//消隐
  28   2       }
  29   1       else
  30   1       {
  31   2              i=0;
  32   2              while(n)//若该数不为0，则一位一位的显示
  33   2              {       
  34   3                      switch(i)        //位选，选择点亮的数码管，
  35   3                      {
  36   4                              case(0):
  37   4                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
  38   4                              case(1):
  39   4                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
  40   4                              case(2):
  41   4                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
  42   4                              case(3):
  43   4                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
  44   4                              case(4):
  45   4                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
  46   4                              case(5):
  47   4                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
  48   4                              case(6):
  49   4                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
  50   4                              case(7):
  51   4                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
  52   4                      }
  53   3      
  54   3                      LEDDAT=table[n%10]; //更新段码
  55   3                      
C51 COMPILER V9.00   LED                                                                   12/08/2019 16:49:42 PAGE 2   

  56   3                      delay_ms(1); //间隔一段时间扫描 
  57   3              
  58   3                  LEDDAT=0x00;//消隐
  59   3                                         
  60   3              n=n/10;
  61   3                      i++;            
  62   3              }
  63   2       }
  64   1      }
  65          void Print_str_LED(u8 *f)//输出数字串到数码管
  66          {
  67   1       u8 i,n;
  68   1       n=strlen(f);
  69   1       for(i=0;i<n;i++)
  70   1       {      
  71   2              switch(i)        //位选，选择点亮的数码管，
  72   2              {
  73   3                      case(0):
  74   3                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
  75   3                      case(1):
  76   3                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
  77   3                      case(2):
  78   3                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
  79   3                      case(3):
  80   3                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
  81   3                      case(4):
  82   3                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
  83   3                      case(5):
  84   3                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
  85   3                      case(6):
  86   3                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
  87   3                      case(7):
  88   3                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
  89   3              }
  90   2                      
  91   2              switch(f[n-i-1])
  92   2              {
  93   3              case '.':n--;LEDDAT=table[f[n-i-1]-'0']|0x80;break;
  94   3              case '-':LEDDAT=0x40;break;
  95   3              case ' ':LEDDAT=0x00;break;
  96   3              default :LEDDAT=table[f[n-i-1]-'0']; 
  97   3              } 
  98   2      
  99   2              delay_ms(1); //间隔一段时间扫描 
 100   2              
 101   2              LEDDAT=0x00;//消隐
 102   2       }
 103   1      }
 104          
 105          void Print_float_LED(float n,u8 x)//输出小数(有效数字不超过8位)到8位数码管，保留x(0-3)位小数
 106          {
 107   1       u8 prtstr[12];
 108   1       switch(x)
 109   1       {
 110   2       case 0:sprintf(prtstr,"%.0f",n);break;
 111   2       case 1:sprintf(prtstr,"%.1f",n);break;
 112   2       case 2:sprintf(prtstr,"%.2f",n);break;
 113   2       case 3:sprintf(prtstr,"%.3f",n);break;
 114   2       } 
 115   1       Print_str_LED(prtstr); 
 116   1      }
 117          
C51 COMPILER V9.00   LED                                                                   12/08/2019 16:49:42 PAGE 3   

 118          void Print_char(u8 n,u8 k)//在指定位置k显示键码n
 119          {
 120   1          switch(k)    //位选，选择点亮的数码管，
 121   1              {
 122   2                      case(0):
 123   2                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
 124   2                      case(1):
 125   2                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
 126   2                      case(2):
 127   2                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
 128   2                      case(3):
 129   2                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
 130   2                      case(4):
 131   2                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
 132   2                      case(5):
 133   2                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
 134   2                      case(6):
 135   2                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
 136   2                      case(7):
 137   2                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
 138   2              }
 139   1          LEDDAT=table[n];//更新段码
 140   1              delay_ms(1); //间隔一段时间扫描 
 141   1              
 142   1              LEDDAT=0x00;//消隐
 143   1      }
 144          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    662    ----
   CONSTANT SIZE    =     37    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      27
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
