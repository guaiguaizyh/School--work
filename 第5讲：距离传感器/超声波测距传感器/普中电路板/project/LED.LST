C51 COMPILER V9.00   LED                                                                   12/08/2019 17:00:21 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN LED.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\KEIL\C51\BIN\C51.EXE LED.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <led.h>
   2          
   3          //数据线接口
   4          #define LEDDAT P0
   5          
   6          //通过译码器输出位选
   7          sbit LSA=P2^2;
   8          sbit LSB=P2^3;
   9          sbit LSC=P2^4;
  10          
  11          
  12          u8 code table[]={
  13          0x3f,0x06,0x5b,0x4f,
  14          0x66,0x6d,0x7d,0x07,
  15          0x7f,0x6f,0x77,0x7c,
  16          0x39,0x5e,0x79,0x71,0x00}; //共阴数码管编码
  17          
  18          void Print_u32_LED(u32 n)//输出6位无符号整数(0-99999999)到8位数码管,不足8位时，前面不显示
  19          {u8 i;
  20   1       if(n==0) //若该数为0时直接显示0
  21   1       {
  22   2              LSA=0;LSB=0;LSC=0; //位选
  23   2      
  24   2              LEDDAT=table[0]; //更新段码
  25   2              
  26   2              delay_ms(1); //间隔一段时间扫描 
  27   2              
  28   2              LEDDAT=0x00;//消隐
  29   2       }
  30   1       else
  31   1       {
  32   2              i=0;
  33   2              while(n)//若该数不为0，则一位一位的显示
  34   2              {       
  35   3                      switch(i)        //位选，选择点亮的数码管，
  36   3                      {
  37   4                              case(0):
  38   4                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
  39   4                              case(1):
  40   4                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
  41   4                              case(2):
  42   4                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
  43   4                              case(3):
  44   4                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
  45   4                              case(4):
  46   4                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
  47   4                              case(5):
  48   4                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
  49   4                              case(6):
  50   4                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
  51   4                              case(7):
  52   4                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
  53   4                      }
  54   3      
  55   3                      LEDDAT=table[n%10]; //更新段码
C51 COMPILER V9.00   LED                                                                   12/08/2019 17:00:21 PAGE 2   

  56   3                      
  57   3                      delay_ms(1); //间隔一段时间扫描 
  58   3              
  59   3                  LEDDAT=0x00;//消隐
  60   3                                         
  61   3              n=n/10;
  62   3                      i++;            
  63   3              }
  64   2       }
  65   1      }
  66          void Print_str_LED(u8 *f)//输出数字串到数码管
  67          {
  68   1       u8 i,n;
  69   1       n=strlen(f);
  70   1       for(i=0;i<n;i++)
  71   1       {      
  72   2              switch(i)        //位选，选择点亮的数码管，
  73   2              {
  74   3                      case(0):
  75   3                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
  76   3                      case(1):
  77   3                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
  78   3                      case(2):
  79   3                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
  80   3                      case(3):
  81   3                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
  82   3                      case(4):
  83   3                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
  84   3                      case(5):
  85   3                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
  86   3                      case(6):
  87   3                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
  88   3                      case(7):
  89   3                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
  90   3              }
  91   2                      
  92   2              switch(f[n-i-1])
  93   2              {
  94   3              case '.':n--;LEDDAT=table[f[n-i-1]-'0']|0x80;break;
  95   3              case '-':LEDDAT=0x40;break;
  96   3              case ' ':LEDDAT=0x00;break;
  97   3              default :LEDDAT=table[f[n-i-1]-'0']; 
  98   3              } 
  99   2      
 100   2              delay_ms(1); //间隔一段时间扫描 
 101   2              
 102   2              LEDDAT=0x00;//消隐
 103   2       }
 104   1      }
 105          
 106          void Print_float_LED(float n,u8 x)//输出小数(有效数字不超过8位)到8位数码管，保留x(0-3)位小数
 107          {
 108   1       u8 prtstr[12];
 109   1       switch(x)
 110   1       {
 111   2       case 0:sprintf(prtstr,"%.0f",n);break;
 112   2       case 1:sprintf(prtstr,"%.1f",n);break;
 113   2       case 2:sprintf(prtstr,"%.2f",n);break;
 114   2       case 3:sprintf(prtstr,"%.3f",n);break;
 115   2       } 
 116   1       Print_str_LED(prtstr); 
 117   1      }
C51 COMPILER V9.00   LED                                                                   12/08/2019 17:00:21 PAGE 3   

 118          
 119          void Print_char(u8 n,u8 k)//在指定位置k显示键码n
 120          {
 121   1          switch(k)    //位选，选择点亮的数码管，
 122   1              {
 123   2                      case(0):
 124   2                                      LSA=0;LSB=0;LSC=0; break;//显示第0位
 125   2                      case(1):
 126   2                                      LSA=1;LSB=0;LSC=0; break;//显示第1位
 127   2                      case(2):
 128   2                                      LSA=0;LSB=1;LSC=0; break;//显示第2位
 129   2                      case(3):
 130   2                                      LSA=1;LSB=1;LSC=0; break;//显示第3位
 131   2                      case(4):
 132   2                                      LSA=0;LSB=0;LSC=1; break;//显示第4位
 133   2                      case(5):
 134   2                                      LSA=1;LSB=0;LSC=1; break;//显示第5位
 135   2                      case(6):
 136   2                                      LSA=0;LSB=1;LSC=1; break;//显示第6位
 137   2                      case(7):
 138   2                                      LSA=1;LSB=1;LSC=1; break;//显示第7位    
 139   2              }
 140   1          LEDDAT=table[n];//更新段码
 141   1              delay_ms(1); //间隔一段时间扫描 
 142   1              
 143   1              LEDDAT=0x00;//消隐
 144   1      }
 145          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    662    ----
   CONSTANT SIZE    =     37    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      27
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
