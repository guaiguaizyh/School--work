C51 COMPILER V9.60.0.0   SEG                                                               06/14/2024 12:29:37 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SEG
OBJECT MODULE PLACED IN seg.OBJ
COMPILER INVOKED BY: E:\danpianji\Keil 5\C51\BIN\C51.EXE seg.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "seg.h"
   2          //共阴极数码管；位选由P2.4、P2.3、P2.2接译码器输出8个位选信号；段码由P0经锁
             -器输出，锁存器锁存引脚接VCC。
   3          u8 seg_buf[10];//要显示的字符串
   4          u8 seg_cod[8];//数码管显示编码
   5          u8 seg_pos=0;//数码管位号
   6          u16 count_500ms=0;//数码管刷新定时，500ms
   7          bit seg_update=0;//数码管定时刷新标记
   8          void seg_tran(u8 seg_buf[],u8 seg_cod[])//转码
   9          {
  10   1        u8 i,j,temp;
  11   1        for(i=0,j=0;i<8;i++,j++)
  12   1        {
  13   2          switch(seg_buf[j])
  14   2          {
  15   3            case '0':temp=0x3F;break;
  16   3            case '1':temp=0x06;break;
  17   3            case '2':temp=0x5B;break;
  18   3            case '3':temp=0x4F;break;
  19   3            case '4':temp=0x66;break;
  20   3            case '5':temp=0x6D;break;
  21   3            case '6':temp=0x7D;break;
  22   3            case '7':temp=0x07;break;
  23   3            case '8':temp=0x7F;break;
  24   3            case '9':temp=0x6F;break;
  25   3            case 'A':temp=0x77;break;
  26   3            case 'B':temp=0x7C;break;
  27   3            case 'C':temp=0x39;break;
  28   3            case 'D':temp=0x5E;break;
  29   3            case 'E':temp=0x79;break;
  30   3            case 'F':temp=0x71;break;     
  31   3            case 'H':temp=0x76;break;
  32   3            case 'L':temp=0x38;break;
  33   3            case 'N':temp=0x37;break;
  34   3            case 'P':temp=0x73;break;
  35   3            case 'U':temp=0x3E;break;
  36   3            case '-':temp=0x40;break;
  37   3            case ' ':temp=0x00;break;
  38   3          }
  39   2          if(seg_buf[j+1]=='.')  {temp=temp|0x80;j++;}
  40   2          seg_cod[i]=temp;
  41   2        }
  42   1      }
  43          
  44          void seg_dis(u8 seg_cod[],u8 seg_pos)//按位显示
  45          {
  46   1        P0=0x00;//段码消影
  47   1        P2=(P2&0xE3)|((7-seg_pos)<<2);//送位码
  48   1        P0=seg_cod[seg_pos];//送段码
  49   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    310    ----
   CONSTANT SIZE    =   ----    ----
C51 COMPILER V9.60.0.0   SEG                                                               06/14/2024 12:29:37 PAGE 2   

   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
