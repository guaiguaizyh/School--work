C51 COMPILER V9.60.0.0   MAIN                                                              05/24/2024 14:08:23 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: E:\danpianji\Keil 5\C51\BIN\C51.EXE app\main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\app) DEBUG OBJECTE
                    -XTEND PRINT(.\main.lst) TABS(2) OBJECT(.\output\main.obj)

line level    source

   1          #include "config.h"
   2          #include "timer.h"
   3          #include "1602.h"
   4          #include "alarm.h"
   5          #include "supersonic.h"
   6          #include "seg.h"
   7          
   8          //void main() //主函数
   9          //{ 
  10          //  float dat;
  11          //  u8 str_buf[30];
  12          //  timer0_init();//定时器初始化，定时1ms
  13          //  LCD1602_Init( );  
  14          //  while(1)
  15          //  {
  16          //    if(measureflag==1)//每隔1秒测温
  17          //    {
  18          //      measureflag=0;
  19          //      dat=ds18b20_TMP();
  20          //      if(dat>35&&dat<45)  alarm=0,led_ctrl(1,ON);
  21          //      else        alarm=1;
  22          //      sprintf(str_buf,"P-%7.2f",dat);//将温度保留2位小数存入字符串seg_buf
  23          //      LCD1602_disstr(str_buf,0,0);//1602液晶显示温度
  24          //    } 
  25          //  }     
  26          //}
  27          bit measureflag=0;
  28          u8 str_buf[20];
  29          u16 xtime;
  30          u8 count;
  31          void main()
  32          {
  33   1        u8 distance;
  34   1        timer0_init();
  35   1        timer1_init();
  36   1        LCD1602_Init();//1602初始化
  37   1        
  38   1        while(1)
  39   1        {
  40   2          if(measureflag==1)
  41   2          {
  42   3            measureflag=0;
  43   3            distance=Measure_Distance();
  44   3            sprintf(str_buf,"distance:%3bu",distance);
  45   3            LCD1602_disstr(str_buf,0,0);
  46   3      //      if(seg_update==1)//每隔0.5秒更新数码管显示
  47   3      //      {
  48   3      //        seg_update=0;
  49   3      //        sprintf(seg_buf,"%3bu",distance);//将距离存入字符串seg_buf
  50   3      //        seg_tran(seg_buf,seg_cod);//转码
  51   3      //      }
  52   3            alarm=1;
  53   3            if(distance>30) alarm=0;
  54   3            else if(distance<30) (xtime=2500,count=120);
C51 COMPILER V9.60.0.0   MAIN                                                              05/24/2024 14:08:23 PAGE 2   

  55   3              else if(distance<25) (xtime=2000,count=100);
  56   3              else if(distance<20) (xtime=1500,count=80);
  57   3              else if(distance<15) (xtime=1000,count=50);
  58   3              else if(distance<10) (xtime=600,count=30);    
  59   3          }
  60   2        }
  61   1      }
  62          void timer0_int() interrupt 1//定时器0定时1ms中断服务函数
  63          {
  64   1        static u16 count_1s=0,n=0;//1秒定时测量计数
  65   1      //定时器T0工作方式1的16位计数值不能自动重装，需要每次中断设置初值
  66   1        TL0 = 0x18;   //设置定时初值
  67   1        TH0 = 0xFC;
  68   1      ////数码管间隔1ms轮流显示8位
  69   1      //  seg_dis(seg_cod,seg_pos);
  70   1      //  seg_pos++;
  71   1      //  if(seg_pos==8) seg_pos=0;
  72   1      //产生1s定时
  73   1        if(++count_1s==1000)
  74   1        {
  75   2          count_1s=0;
  76   2          measureflag=1;
  77   2        } 
  78   1        if(alarm==1)//LED闪烁，蜂鸣器响
  79   1        {
  80   2          ++n;//蜂鸣器报警，频率500
  81   2          if(n<=500)
  82   2          {
  83   3            if(n%2) beep=1,led_ctrl(4,ON);
  84   3            else    beep=0,led_ctrl(4,OFF);
  85   3          }   
  86   2          else if(n<xtime) beep=1;
  87   2          else n=0;
  88   2        }
  89   1        if(n<=count)
  90   1        {led_ctrl(4,ON);}
  91   1        else if(n<=count*2)
  92   1        {led_ctrl(4,OFF);}
  93   1        else n=0;
  94   1      }
  95            


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    386    ----
   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     27       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
