C51 COMPILER V9.60.0.0   DHT11                                                             05/11/2024 17:27:31 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN .\output\dht11.obj
COMPILER INVOKED BY: E:\danpianji\Keil 5\C51\BIN\C51.EXE app\dht11.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\app) DEBUG OBJECT
                    -EXTEND PRINT(.\dht11.lst) TABS(2) OBJECT(.\output\dht11.obj)

line level    source

   1          #include "dht11.h"
   2          
   3          
   4          
   5          void DHT11_start()//启动
   6          {
   7   1         Data=1;
   8   1         delay_us(2);
   9   1         Data=0;
  10   1         delay_ms(20);   //延时18ms以上
  11   1         Data=1;
  12   1         delay_us(30);
  13   1      }
  14          
  15          u8 DHT11_rec_byte()      //接收一个字节
  16          {
  17   1        u8 i,dat=0;
  18   1        for(i=0;i<8;i++)    //从高到低依次接收8位数据
  19   1         {          
  20   2            while(!Data);   ////等待50us低电平过去
  21   2            delay_us(8);     //延时60us，如果还为高则数据为1，否则为0 
  22   2            dat<<=1;           //移位使正确接收8位数据，数据为0时直接移位
  23   2            if(Data==1)    //数据为1时，使dat加1来接收数据1
  24   2               dat+=1;
  25   2            while(Data);  //等待数据线拉低    
  26   2          }  
  27   1          return dat;
  28   1      }
  29          
  30          void DHT11_receive(u8 *RHum,u8 *Temp) //读取测量数据，并校验，然后将温湿度值返回到形
             -参中
  31          {
  32   1          u8 R_H,R_L,T_H,T_L,revise; 
  33   1          DHT11_start();
  34   1          EA=0;
  35   1          if(Data==0)
  36   1          {
  37   2              while(Data==0);   //等待拉高     
  38   2              delay_us(40);  //拉高后延时80us
  39   2              R_H=DHT11_rec_byte();    //接收湿度高八位  
  40   2              R_L=DHT11_rec_byte();    //接收湿度低八位  
  41   2              T_H=DHT11_rec_byte();    //接收温度高八位  
  42   2              T_L=DHT11_rec_byte();    //接收温度低八位
  43   2              revise=DHT11_rec_byte(); //接收校正位
  44   2      
  45   2              delay_us(25);    //结束
  46   2      
  47   2              if((R_H+R_L+T_H+T_L)==revise)      //校正
  48   2              {
  49   3                  *RHum=R_H;            
  50   3                  *Temp=T_H;             
  51   3              }        
  52   2          }
  53   1          EA=1;
C51 COMPILER V9.60.0.0   DHT11                                                             05/11/2024 17:27:31 PAGE 2   

  54   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    177    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      13
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
